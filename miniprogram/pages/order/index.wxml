<view class="container">
  <!-- æ ‡ç­¾å¯¼èˆª -->
  <view class="tab-navigation">
    <view
      class="tab-item {{currentTab === 'all' ? 'active' : ''}}"
      data-tab="all"
      bindtap="onTabChange"
    >
      å…¨éƒ¨
    </view>
    <view
      class="tab-item {{currentTab === 'pending' ? 'active' : ''}}"
      data-tab="pending"
      bindtap="onTabChange"
    >
      å¾…æ”¯ä»˜
    </view>
    <view
      class="tab-item {{currentTab === 'completed' ? 'active' : ''}}"
      data-tab="completed"
      bindtap="onTabChange"
    >
      å·²å®Œæˆ
    </view>
    <view
      class="tab-item {{currentTab === 'cancelled' ? 'active' : ''}}"
      data-tab="cancelled"
      bindtap="onTabChange"
    >
      å·²å–æ¶ˆ
    </view>
  </view>

  <!-- ç©ºè®¢å• -->
  <view wx:if="{{!loading && orders.length === 0}}" class="empty-state">
    <view class="empty-icon">ğŸ“‹</view>
    <view class="empty-text">æš‚æ— è®¢å•</view>
  </view>

  <!-- è®¢å•åˆ—è¡¨ -->
  <view class="orders-list">
    <view wx:for="{{orders}}" wx:key="id" class="order-card">
      <!-- è®¢å•å¤´éƒ¨ -->
      <view class="order-header">
        <view class="order-info">
          <view class="order-number">è®¢å•å·: {{item.order_no}}</view>
          <view class="order-date">{{item.created_at}}</view>
        </view>
        <view class="order-status {{item.status}}">
          {{getStatusLabel(item.status)}}
        </view>
      </view>

      <!-- è®¢å•å•†å“ -->
      <view class="order-items">
        <view wx:for="{{item.items}}" wx:key="id" wx:for-item="product" class="order-item">
          <image
            class="item-image"
            src="{{product.image_url || '/images/placeholder.png'}}"
          />
          <view class="item-details">
            <view class="item-name">{{product.name}}</view>
            <view class="item-quantity">x{{product.quantity}}</view>
          </view>
          <view class="item-price">Â¥{{product.price}}</view>
        </view>
      </view>

      <!-- è®¢å•é‡‘é¢ -->
      <view class="order-summary">
        <view class="summary-row">
          <text class="label">å°è®¡:</text>
          <text class="value">Â¥{{item.total_amount}}</text>
        </view>
        <view class="summary-row" wx:if="{{item.discount_amount > 0}}">
          <text class="label">ä¼˜æƒ :</text>
          <text class="value discount">-Â¥{{item.discount_amount}}</text>
        </view>
        <view class="summary-row highlight">
          <text class="label">åº”ä»˜:</text>
          <text class="value">Â¥{{item.actual_amount}}</text>
        </view>
      </view>

      <!-- è®¢å•æ“ä½œ -->
      <view class="order-actions">
        <button class="action-btn secondary" bindtap="viewOrderDetail" data-id="{{item.id}}">
          è¯¦æƒ…
        </button>
        <button
          class="action-btn danger"
          wx:if="{{item.status === 'pending'}}"
          data-id="{{item.id}}"
          bindtap="cancelOrder"
        >
          å–æ¶ˆ
        </button>
        <button class="action-btn" wx:if="{{item.status === 'completed'}}" data-id="{{item.id}}" bindtap="deleteOrder">
          åˆ é™¤
        </button>
      </view>
    </view>
  </view>

  <!-- åŠ è½½æç¤º -->
  <view wx:if="{{loading}}" class="loading-indicator">
    <view class="spinner"></view>
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>

  <view wx:if="{{!hasMore && orders.length > 0}}" class="no-more">
    å·²ç»æ²¡æœ‰æ›´å¤šè®¢å•äº†
  </view>
</view>
